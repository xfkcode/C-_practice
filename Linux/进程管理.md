# 进程管理

## 1. 进程相关概念

### 1.1 程序和进程

- 程序，是指编译好的二进制文件，在磁盘上，占用磁盘空间，是一个静态的概念
- 进程，一个启动的程序，进程占用的是系统资源，如：物理内存，CUP，终端等，是一个动态的概念

【:ticket:】程序 $\rightarrow$ 剧本，进程 $\rightarrow$ 戏  
             同一个剧本可以在多个舞台同时上演。同样，同一个程序也可以加载为不同的进程（彼此之间互不影响）  
             每启动一个程序就会有一个进程PID，即使是相同的程序多次启动也会有不同的PID

### 1.2 并发和并行 

- 并发，在一个时间段内，是在同一个cpu上，同时运行多个程序
- 并行，在一个时间片内，有多个程序在执行（多核cpu）

【:loudspeaker:】cup将一个大的时间段分成多个小的时间片，让进程轮流使用cpu的时间片

### 1.3 PCB进程控制块

每个进程在内核中都有一个进程控制块（PCB）来维护进程相关的信息，Linux内核的进程控制块是 `task_struct` 结构体

- 进程id，系统中每个进程有唯一的id，在C语言中用 `pid_t` 类型表示，其实就是一个非负整数
- 进程的状态，有就绪、运行、挂起、终止等状态
- 进程切换时需要保存和恢复的一些cpu寄存器
- 描述虚拟地址空间的信息
- 描述控制终端的信息
- 当前工作目录  
  `getcwd` 获取当前工作目录
- `umask` 掩码
- 文件描述符表，包含很多指向 file 结构体的指针
- 和信号相关的信息
- 用户 id 和组 id
- 会话和进程组
- 进程可以使用的资源上限  
  `ulimit -a` 查看资源上限

### 1.4 进程状态

- 运行，进程获得cpu时间片，有执行资格，在cpu时间片用完后进入就绪状态

- 就绪，进程有执行资格，但没有或得cpu时间片，在获得cpu时间片后进入运行状态

- 挂起，进程没有执行资格，不能获取cpu时间片（就绪、运行均可直接转挂起）  
  从挂起状态不能直接回到运行态，必须先回到就绪状态，再进入运行状态

- 终止，进程结束（就绪、运行、挂起均可直接转终止）



---
> ✍️ [邢福凯 (xfkcode@github)](https://github.com/xfkcode)  
> 📅 **写于2023年1月** 