# 守护进程和线程

## 1. 守护进程

### 1.1 守护进程介绍

**Daemon**（精灵）进程，是Linux中的后台服务进程，通常独立于控制终端并且周期性地执行某种任务或等待处理某些发生的事件。  
一般采取以d结尾的名字，如：`vsftpd` 

Linux后台的一些系统服务进程，没有控制终端，不能直接和用户交互。不受用户登录、注销的影响，一直在运行着，他们都是守护进程。  
如：预读入缓输出机制的实现；`ftp` 服务器；`nfs` 服务器等。

【:ticket:】**守护进程特点**   
            :one: Linux后台服务进程  :two: 独立于控制终端  :three: 周期性的执行某种任务  :four: 不受用户登录和注销的影响  :five: 一般采用d结尾的名字

### 1.2 进程组和会话

- **进程组** 
  - **进程组是一个或者多个进程的集合**，每个进程都属于一个进程组，引入进程组是为了进化对进程的管理。当父进程创建子进程的时候，默认子进程与父进程属于同一个进程组

【:boxing_glove:】**进程组ID == 第一个进程ID（组长进程）**  
             如父进程创建了多个子进程，父进程和多个子进程同属于一个组，而且父进程是进程组里的第一个进程，所以父进程就是这个组的组长  
             组长ID == 父进程ID

【:warning:】`kill -SIGKILL -进程组ID(负)` 杀死进程组所有进程

【:four_leaf_clover:】进程组生存期：从进程创建到最后一个进程离开  
            只要进程组中有一个进程存在，进程组就存在，与组长进程是否终止无关

- **会话** 
  - **一个会话是一个或多个进程组的集合** 

【:key:】创建会话的进程不能是进程组组长  
             创建会话的进程成为一个进程的组长进程，同时也成为会话的会长  
             需要root权限（有的系统不需要）  
             新创建的会话丢弃原有的控制终端

【:tractor:】创建新会话  
             先调用 `fork` ，父进程终止，子进程调用 `setsid` 函数

`ps ajx` 查看进程组ID和会话ID  
`PPID` 父进程ID  `PID` 进程ID  `PGID` 进程组ID `SID` 会话ID

```Linux
[xfk@centos COMP_SIGNAL]$ ps ajx
  PPID    PID   PGID    SID TTY       TPGID STAT   UID   TIME COMMAND
     0      1      1      1 ?            -1 Ss       0   0:03 /usr/lib/systemd/sys
     0      2      0      0 ?            -1 S        0   0:00 [kthreadd]
     2      3      0      0 ?            -1 S        0   0:00 [ksoftirqd/0]
  ...
```

### 1.3 创建守护进程的模型

## 2. 线程

## 3. 线程属性

## 4. 线程同步





---
> ✍️ [邢福凯 (xfkcode@github)](https://github.com/xfkcode)  
> 📅 **写于2023年1月**  